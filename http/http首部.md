# http/1.1 首部

## 首部字段一览

摘自[图解 HTTP](https://www.ituring.com.cn/book/1229)

### 通用首部字段

| 首部字段名        | 说明                                              |
| ----------------- | ------------------------------------------------- |
| Warning           | 错误通知                                          |
| Connection        | 逐跳首部、连接的管理                              |
| Cache-Control     | 控制缓存行为，详见[Cache-Control](#cache-control) |
| Transfer-Encoding | 指定报文主体的传输编码方式                        |
| Trailer           | 报文末端的首部一览                                |
| Pragma            | 报文指令                                          |
| Upgrade           | 升级为其他协议                                    |
| Date              | 创建报文的时间                                    |
| Via               | 代理服务器的相关信息                              |

### 请求首部字段

| 首部字段名          | 说明                                                                    |
| ------------------- | ----------------------------------------------------------------------- |
| Accept              | 用户代理可处理的媒体类型，值的形式：type/subtype，详见[Accept](#accept) |
| Accept-Charset      | 优先的字符集                                                            |
| Accept-Encoding     | 优先的内容编码                                                          |
| Accept-Language     | 优先的语言（自然语言）                                                  |
| Authorization       | Web 认证信息                                                            |
| Except              | 期待服务器的特定行为                                                    |
| From                | 用户的电子邮件地址                                                      |
| Host                | 请求资源所在服务器                                                      |
| If-Match            | 比较实体标记（ETag）                                                    |
| If-Modified-Since   | 比较资源的更新时间                                                      |
| If-None-Match       | 比较实体标记（与 If-Match 相反）                                        |
| If-Range            | 资源未更新时发送实体 Byte 的范围请求                                    |
| If-Unmodified-Since | 比较资源的更新时间（与 If-Modified-Since 相反）                         |
| Max-Forwards        | 最大传输逐跳数                                                          |
| Proxy-Authorization | 代理服务器要求客户端的认证信息                                          |
| Range               | 实体的字节范围请求                                                      |
| Referer             | 对请求中 URI 的原始获取方                                               |
| TE                  | 传输编码的优先级                                                        |
| User-Agent          | HTTP 客户端程序的信息                                                   |

### 响应首部字段

| 首部字段名         | 说明                         |
| ------------------ | ---------------------------- |
| Accept-Range       | 是否接受字节范围请求         |
| Age                | 推算资源创建时间             |
| ETag               | 资源的匹配信息               |
| Location           | 令客户端重定向至指定 URI     |
| Proxy-Authenticate | 代理服务器对客户端的认证信息 |
| Retry-After        | 对再次发送请求的时机要求     |
| Server             | HTTP 的服务器安装信息        |
| Vary               | 代理服务器缓存的管理信息     |
| WWW-Authenticate   | 服务器对客户端的认证信息     |

### 实体首部字段

| 首部字段名       | 说明                                                                         |
| ---------------- | ---------------------------------------------------------------------------- |
| Allow            | 资源可支持的 HTTP 方法                                                       |
| Content-Encoding | 实体主体适用的编码方式                                                       |
| Content-Language | 实体主体的自然语言                                                           |
| Content-Length   | 实体主体的字节大小                                                           |
| Content-Location | 替代对应资源的 URI                                                           |
| Content-MD5      | 实体主体的报文摘要                                                           |
| Content-Range    | 实体主体的位置范围                                                           |
| Content-Type     | 实体主体的媒体类型，同 Accept，值的形式：type/subtype，详见[Accept](#accept) |
| Expires          | 实体主体过期的时间                                                           |
| Last-Modified    | 资源最后修改时间                                                             |

### 为 cookie 服务的首部字段

#### Set-Cookie

响应首部字段，由服务器返回，开始状态管理所使用的 Cookie 信息。

```http
Set-Cookie: cookiename=enable;expires=Tue, 07 Jul 2020 23:26:32 GMT;path=/;domain=.zxingis.com;Secure;HttpOnly;
```

| 属性名       | 说明                                                                                                                                                                                                                |
| ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| NAME=VALUE   | 赋予 Cookie 的名称和其值（必需）                                                                                                                                                                                    |
| expires=DATE | Cookie 的有效期（若不明确指定则默认为浏览器关闭前为止，参考 Session）。Cookie 一旦存储在客户端，服务端不具备删除 Cookie 的功能，仅能通过覆盖值来进行变相删除                                                        |
| path=PATH    | 指定服务器上适用于该 Cookie 的文件目录对象（若不指定则默认为文档所在的目录）。指定为`/a`的话，则`/`无法访问，`/a/b`和`/a/c/d`等可以访问该 Cookie                                                                    |
| domain=域名  | 作为服务器适用对象的域名（若不指定则默认为创建 Cookie 的服务器域名）。该属性指定的域名可以做结尾匹配，即值为`zxingis.com`的话，`www.zxingis.com`和`www2.zxingis.com`也可以发送 Cookie。所以除非必要，不指定值更安全 |
| Secure       | 限制仅在 HTTPS 安全通信时才能发送 Cookie                                                                                                                                                                            |
| HttpOnly     | 限制 Cookie 被 JavaScript 脚本操作。可以防止 XSS 攻击                                                                                                                                                               |

#### Cookie

请求首部字段，传给服务器的 Cookie 信息，有多个的话，则以多个 Cookie 形式发送

```http
Cookie: cookiename=enable;
```

### 补充

#### Cache-Control

Cache-Control 可以操作混存的工作机制，由多个指令构成：

```http
Cache-Control: private, max-age=0, no-cache
```

##### 缓存请求指令

| 指令             | 参数   | 说明                                                                                                                                                     |
| ---------------- | ------ | -------------------------------------------------------------------------------------------------------------------------------------------------------- |
| no-cache         | 无     | 强制向源服务器再次验证，不缓存过期的资源（协商缓存）                                                                                                     |
| no-store         | 无     | 不缓存请求或者响应的任何内容                                                                                                                             |
| max-age=[秒]     | 必需   | 表示缓存最大时长，超过这个时长则缓存过期，时间相对于请求时间。如果该值为 0，缓存服务器则需要向源服务器转发请求                                           |
| max-stale(=[秒]) | 可忽略 | 可接受已过期的响应。如果指令未指定参数值，那么无论过多久，客户端都会接受缓存响应；如果指定了数值，那么即使缓存过期，只要仍处于指定的时间内，依旧会被接收 |
| min-fresh=[秒]   | 必需   | 希望获取一个能在指定的秒数内保持其最新状态的响应。缓存服务器中在指定时间内如果有超过有效期限的资源（过期）都无法作为响应返回                             |
| no-transform     | 无     | 代理不可更改媒体类型                                                                                                                                     |
| only-if-cached   | 无     | 只接受缓存服务器中已缓存的响应，并且不要向源服务器检查是否有更新的拷贝；如果不存在该缓存资源，则返回 504 Gateway Timeout                                 |
| cache-extension  | -      | 新指令标记（token）                                                                                                                                      |

##### 缓存响应指令

| 指令             | 参数   | 说明                                                                                                                                                                           |
| ---------------- | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| public           | 无     | 可向任意方提供响应的缓存                                                                                                                                                       |
| private          | 无     | 仅向特定用户提供返回缓存的服务，其他用户则不会返回缓存                                                                                                                         |
| no-cache         | 可忽略 | 强制向服务器再次验证，不缓存过期的资源（协商缓存）。如果具有参数值，那么客户端在接收到这个被指定参数值的首部字段的响应报文后，就不能使用缓存，即无参数值的首部字段可以使用缓存 |
| no-store         | 无     | 不缓存请求或者响应的任何内容                                                                                                                                                   |
| no-transform     | 无     | 代理不可更改媒体类型，可以防止缓存或者代理压缩图片等操作                                                                                                                       |
| must-revalidate  | 无     | 要求返回响应之前向源服务器对资源的有效性再进行确认。该指令存在的情况下会忽略 max-stale 指令                                                                                    |
| proxy-revalidate | 无     | 要求中间缓存服务器对缓存的响应有效性再进行确认，仅适用于共享缓存（public），私有缓存（private）会忽略该指令                                                                    |  |
| max-age=[秒]     | 必需   | 表示缓存最大时长，超过这个时长则缓存过期，时间相对于请求时间。在 HTTP/1.1 中，如果同时存在该指令和 Expires 首部字段，则忽略 Expires；在 HTTP/1.0 中，则会忽略该字段            |
| s-maxage=[秒]    | 必需   | 公共缓存服务器响应的最大 Age 值。如果该指令存在，则直接忽略 max-stale 指令和 Expires 首部字段的值                                                                              |
| cache-extension  | -      | 新指令标记（token）                                                                                                                                                            |

#### Accept
